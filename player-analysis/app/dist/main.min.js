!function(){"use strict";function e(e,t){t.otherwise("/"),e.state("home",{url:"/",templateUrl:"components/home/home.html",controller:"Home.Controller",controllerAs:"vm",data:{activeTab:"home"}}).state("customerModel",{url:"/customerModel",templateUrl:"components/customerModel/customerModel.html",controller:"CustomerModel.Controller",controllerAs:"vm",data:{activeTab:"customerModel"}}).state("dashBoard",{url:"/dashBoard",templateUrl:"components/dashBoard/dashBoard.html",controller:"DashBoard.Controller",controllerAs:"vm",data:{activeTab:"dashBoard"}}).state("playerCampaign",{url:"/playerCampaign",templateUrl:"components/playerCampaign/index.html",controller:"PlayerCampaign.IndexController",controllerAs:"vm",data:{activeTab:"playerCampaign"}}).state("analyticalReps",{url:"/analyticalReps",templateUrl:"components/analyticalReps/analyticalreps.html",controller:"analyticalcontroller",controllerAs:"vm",data:{activeTab:"analyticalReps"}}).state("account",{url:"/account",templateUrl:"components/account/account.html",controller:"Account.Controller",controllerAs:"vm",data:{activeTab:"account"}})}function t(e,t,i){e.defaults.headers.common.Authorization="Bearer "+i.jwtToken,t.$on("$stateChangeSuccess",function(e,i,a,o,n){t.activeTab=i.data.activeTab})}angular.module("app",["ui.router","highcharts-ng","LocalStorageModule","angularjs-dropdown-multiselect","hljs","ui.bootstrap"]).config(e).service("$applicationService",["$http","localStorageService",function(e,t){var i=null;return{customerModelDataData:function(e){return e?(i=e,void t.set("graphs.customerModelData",e)):i||t.get("graphs.customerModelData")}}}]).run(t),$(function(){$.get("/app/token",function(e){window.jwtToken=e,angular.bootstrap(document,["app"])})})}(),function(){"use strict";function e(e){function t(){e.GetCurrent().then(function(e){i.user=e})}var i=this;i.user=null,t()}angular.module("app").controller("Home.Controller",e)}(),function(){"use strict";angular.module("app").controller("CustomerModel.Controller",function(e,t,i){function a(){t.get("/getfiles").success(function(t){console.log("success!"),i.customerModelDataData(t);for(var a,n=[],l=[],r=0,s=0;s<t.life_cycle.length;s++)t.life_cycle[s].Period!==a&&(n[r]={periodID:t.life_cycle[s].Period},r+=1,a=t.life_cycle[s].Period);for(var c=0;c<t.life_cycle.length;c++)t.life_cycle[c].Period===n[0].periodID&&(l[c]={label:t.life_cycle[c].life_cycle_stages,id:t.life_cycle[c].life_cycle_stages});e.periodList=n,e.lifeCycleStagedata=l,o()})}function o(){e.daysSinceRegList.data=n(e.distribution.period,"days_since_reg"),e.daysSinceLastActivityList.data=n(e.distribution.period,"days_since_last_activity"),e.playerActivityList.data=n(e.distribution.period,"player_activity"),e.productReferenceList.data=n(e.distribution.period,"product_preferences"),e.valueSegmentList.data=n(e.distribution.period,"valueseg"),c(),r()}function n(e,t){var a,o=[],n=i.customerModelDataData()[t],l=0;for(a=0;a<n.length;a++)if(n[a].Period===e){var r=n[a];console.log("Data::",r),o[l]=r,l+=1}return o}function l(e,t,a,o,n){var l,r=[],s=i.customerModelDataData()[t],c=0;for(l=0;l<s.length;l++)if(s[l].Period===e){var d={name:s[l][a],y:n?Number((100*s[l][o]).toFixed(2)):Number(s[l][o])};console.log("Data::",d),r[c]=d,c+=1}return r}function r(){e.lifeCyclePiechartConfig={options:{chart:{plotBackgroundColor:null,plotBorderWidth:null,plotShadow:!1,type:"pie"},plotOptions:{pie:{allowPointSelect:!0,cursor:"pointer",dataLabels:{enabled:!1},showInLegend:!0}},legend:{enabled:!0,align:"right",verticalAlign:"top",labelFormat:"{name}- {y}%",layout:"vertical"},credits:{enabled:!1},tooltip:{pointFormat:"{series.name}: <b>{point.y}%</b>"}},title:{text:"Distribution",align:"left"},series:[{name:"Distribution",colorByPoint:!0,data:l(e.distribution.period,"life_cycle","life_cycle_stages","distribution",!0)}],loading:!1},e.lifeCycleBarchartConfig={options:{chart:{type:"column"},plotOptions:{pie:{allowPointSelect:!0,cursor:"pointer",dataLabels:{enabled:!1},showInLegend:!0}},credits:{enabled:!1},legend:{enabled:!1}},title:{text:"Avg.Future value",align:"left"},xAxis:{type:"category",labels:{rotation:0,style:{fontSize:"13px",fontFamily:"Verdana, sans-serif"}}},yAxis:{min:0,title:{text:""}},series:[{name:"Avg.Future Value",data:l(e.distribution.period,"life_cycle","life_cycle_stages","avg_future_value",!1),dataLabels:{enabled:!0,color:"#FFFFFF",align:"right",format:"{point.y:,.0f}",style:{fontSize:"13px",fontFamily:"Verdana, sans-serif"}}}],loading:!1},e.daysSinceRegPiechartConfig={options:{chart:{plotBackgroundColor:null,plotBorderWidth:null,plotShadow:!1,type:"pie"},plotOptions:{pie:{allowPointSelect:!0,cursor:"pointer",dataLabels:{enabled:!1},showInLegend:!0}},legend:{enabled:!0,align:"right",verticalAlign:"top",labelFormat:"{name}- {y}%",layout:"vertical"},credits:{enabled:!1},tooltip:{pointFormat:"{series.name}: <b>{point.y}%</b>"}},title:{text:"Distribution",align:"left"},series:[{name:"Distribution",colorByPoint:!0,data:l(e.distribution.period,"days_since_reg","days_since_reg","distribution",!0)}],loading:!1},e.daysSinceRegBarchartConfig={options:{chart:{type:"column"},plotOptions:{pie:{allowPointSelect:!0,cursor:"pointer",dataLabels:{enabled:!1},showInLegend:!0}},credits:{enabled:!1},legend:{enabled:!1}},title:{text:"Future value",align:"left"},xAxis:{type:"category",labels:{rotation:0,style:{fontSize:"13px",fontFamily:"Verdana, sans-serif"}}},yAxis:{min:0,title:{text:""}},series:[{name:"Future Value",data:l(e.distribution.period,"days_since_reg","days_since_reg","future_value",!1),dataLabels:{enabled:!0,align:"right",format:"{point.y}",style:{fontSize:"13px",fontFamily:"Verdana, sans-serif"}}}],loading:!1}}function s(){e.$$phase||e.$apply()}function c(){var t=0,i=[],a=n(e.distribution.period,"micro_seg"),o=e.lifeCycleStageModel;if(0===o.length)return void(e.microSegmentList.data=[]);for(var l=0;l<o.length;l++)for(var r=0;r<a.length;r++)if(a[r].life_cycle_stages===o[l].id){var c=a[r];console.log("Data::",c),i[t]=c,t+=1}e.microSegmentList.data=i,s()}e.lifeCycleData=[],e.distribution={period:"2016_09_10"},e.daysSinceRegList={data:[]},e.daysSinceLastActivityList={data:[]},e.playerActivityList={data:[]},e.productReferenceList={data:[]},e.microSegmentList={data:[]},e.valueSegmentList={data:[]},e.lifeCycleStageModel=[{id:"Non Depositor"}],e.showDaysSinceReg=!0,e.showDaysSinceLastActivity=!1,e.showProductRefs=!1,e.showPlayerActivity=!1,a(),e.updateGraph=function(){console.log("inside updateGraph",e.distribution.period),e.lifeCyclePiechartConfig.series[0].data=l(e.distribution.period,"life_cycle","life_cycle_stages","distribution",!0),e.lifeCycleBarchartConfig.series[0].data=l(e.distribution.period,"life_cycle","life_cycle_stages","avg_future_value",!1),e.daysSinceRegPiechartConfig.series[0].data=l(e.distribution.period,"days_since_reg","days_since_reg","distribution",!0),e.daysSinceRegBarchartConfig.series[0].data=l(e.distribution.period,"days_since_reg","days_since_reg","future_value",!1),"undefined"!=typeof e.daysSinceLastPiechartConfig&&(e.daysSinceLastPiechartConfig.series[0].data=l(e.distribution.period,"days_since_last_activity","days_since_last_activity","distribution",!0),e.daysSinceLastBarchartConfig.series[0].data=l(e.distribution.period,"days_since_last_activity","days_since_last_activity","future_value",!1)),"undefined"!=typeof e.playerActivityPiechartConfig&&(e.playerActivityPiechartConfig.series[0].data=l(e.distribution.period,"player_activity","player_activity","distribution",!0),e.playerActivityBarchartConfig.series[0].data=l(e.distribution.period,"player_activity","player_activity","future_value",!1)),"undefined"!=typeof e.productReferencePiechartConfig&&(e.productReferencePiechartConfig.series[0].data=l(e.distribution.period,"product_preferences","Activity_type","distribution",!0),e.productReferenceBarchartConfig.series[0].data=l(e.distribution.period,"product_preferences","Activity_type","future_value",!1)),o()},e.displyDaysSinceReg=function(){e.showDaysSinceReg=!0,e.showDaysSinceLastActivity=!1,e.showProductRefs=!1,e.showPlayerActivity=!1},e.displyDaysSinceLast=function(){e.showDaysSinceReg=!1,e.showDaysSinceLastActivity=!0,e.showProductRefs=!1,e.showPlayerActivity=!1,e.daysSinceLastPiechartConfig={options:{chart:{plotBackgroundColor:null,plotBorderWidth:null,plotShadow:!1,type:"pie"},colors:["#ED561B","#5C2508","#e45d15","#50B432","#058DC7"],plotOptions:{pie:{allowPointSelect:!0,cursor:"pointer",dataLabels:{enabled:!1},showInLegend:!0}},legend:{enabled:!0,align:"right",verticalAlign:"top",labelFormat:"{name}- {y}%",layout:"vertical"},credits:{enabled:!1},tooltip:{pointFormat:"{series.name}: <b>{point.y}%</b>"}},title:{text:"Distribution",align:"left"},series:[{name:"Distribution",data:l(e.distribution.period,"days_since_last_activity","days_since_last_activity","distribution",!0)}],loading:!1},e.daysSinceLastBarchartConfig={options:{chart:{type:"column"},plotOptions:{pie:{allowPointSelect:!0,cursor:"pointer",dataLabels:{enabled:!1},showInLegend:!0}},credits:{enabled:!1},legend:{enabled:!1}},title:{text:"Future value",align:"left"},xAxis:{type:"category",labels:{rotation:0,style:{fontSize:"13px",fontFamily:"Verdana, sans-serif"}}},yAxis:{min:0,title:{text:""}},series:[{name:"Future Value",colorByPoint:!0,data:l(e.distribution.period,"days_since_last_activity","days_since_last_activity","future_value",!1),dataLabels:{enabled:!0,align:"right",format:"{point.y}",style:{fontSize:"13px",fontFamily:"Verdana, sans-serif"}}}],loading:!1}},e.displyPlayerActivity=function(){e.showDaysSinceReg=!1,e.showDaysSinceLastActivity=!1,e.showProductRefs=!1,e.showPlayerActivity=!0,e.playerActivityPiechartConfig={options:{chart:{plotBackgroundColor:null,plotBorderWidth:null,plotShadow:!1,type:"pie"},colors:["#ED561B","#5C2508","#e45d15","#50B432","#058DC7"],plotOptions:{pie:{allowPointSelect:!0,cursor:"pointer",dataLabels:{enabled:!1},showInLegend:!0}},legend:{enabled:!0,align:"right",verticalAlign:"top",labelFormat:"{name}- {y}%",layout:"vertical"},credits:{enabled:!1},tooltip:{pointFormat:"{series.name}: <b>{point.y}%</b>"}},title:{text:"Distribution",align:"left"},series:[{name:"Distribution",colorByPoint:!0,data:l(e.distribution.period,"player_activity","player_activity","distribution",!0)}],loading:!1},e.playerActivityBarchartConfig={options:{chart:{type:"column"},color:["#ED561B","#5C2508","#e45d15"],plotOptions:{pie:{allowPointSelect:!0,cursor:"pointer",dataLabels:{enabled:!1},showInLegend:!0}},credits:{enabled:!1},legend:{enabled:!1}},title:{text:"Future value",align:"left"},xAxis:{type:"category",labels:{rotation:0,style:{fontSize:"13px",fontFamily:"Verdana, sans-serif"}}},yAxis:{min:0,title:{text:""}},series:[{name:"Future Value",data:l(e.distribution.period,"player_activity","player_activity","future_value",!1),dataLabels:{enabled:!0,colorByPoint:!0,align:"right",format:"{point.y}",style:{fontSize:"13px",fontFamily:"Verdana, sans-serif"}}}],loading:!1}},e.displyProductPreference=function(){e.showDaysSinceReg=!1,e.showDaysSinceLastActivity=!1,e.showProductRefs=!0,e.showPlayerActivity=!1,e.productReferencePiechartConfig={options:{chart:{plotBackgroundColor:null,plotBorderWidth:null,plotShadow:!1,type:"pie"},colors:["#ED561B","#5C2508","#e45d15","#50B432","#058DC7"],plotOptions:{pie:{allowPointSelect:!0,cursor:"pointer",dataLabels:{enabled:!1},showInLegend:!0}},legend:{enabled:!0,align:"right",verticalAlign:"top",labelFormat:"{name}- {y}%",layout:"vertical"},credits:{enabled:!1},tooltip:{pointFormat:"{series.name}: <b>{point.y}%</b>"}},title:{text:"Distribution",align:"left"},series:[{name:"Distribution",colorByPoint:!0,data:l(e.distribution.period,"product_preferences","Activity_type","distribution",!0)}],loading:!1},e.productReferenceBarchartConfig={options:{chart:{type:"column"},plotOptions:{pie:{allowPointSelect:!0,cursor:"pointer",dataLabels:{enabled:!1},showInLegend:!0}},credits:{enabled:!1},legend:{enabled:!1}},title:{text:"Future value",align:"left"},xAxis:{type:"category",labels:{rotation:0,style:{fontSize:"13px",fontFamily:"Verdana, sans-serif"}}},yAxis:{min:0,title:{text:""}},series:[{name:"Future Value",data:l(e.distribution.period,"product_preferences","Activity_type","future_value",!1),dataLabels:{enabled:!0,colorByPoint:!0,align:"right",format:"{point.y}",style:{fontSize:"13px",fontFamily:"Verdana, sans-serif"}}}],loading:!1}},e.lifeCycleStageSettings={scrollableHeight:"200px",scrollable:!0,enableSearch:!0},e.lifeCycleStageTexts={checkAll:"All",uncheckAll:"None",selectionCount:"checked",selectionOf:"/",searchPlaceholder:"Quick Find...",buttonDefaultText:"Select",dynamicButtonTextSuffix:"checked"},e.microSegEvents={onSelectAll:function(e){c()},onItemDeselect:function(e){c()},onItemSelect:function(e){c()},onDeselectAll:function(t){e.microSegmentList.data=[]},onInitDone:function(e){c()}}})}(),function(){"use strict";angular.module("app").controller("DashBoard.Controller",function(e,t,i,a,o){function n(){t.get("/getfiles").success(function(t){console.log("success!"),a.customerModelDataData(t);for(var i,o=[],n=[],r=0,s=0;s<t.life_cycle.length;s++)t.life_cycle[s].Period!==i&&(o[r]={periodID:t.life_cycle[s].Period},r+=1,i=t.life_cycle[s].Period);for(var c=0;c<t.life_cycle.length;c++)t.life_cycle[c].Period===o[0].periodID&&(n[c]={label:t.life_cycle[c].life_cycle_stages,id:t.life_cycle[c].life_cycle_stages});e.periodList=o,e.lifeCycleStagedata=n,l()})}function l(){e.mecampaignsList.data=a.customerModelDataData().effective_campaigns,e.customKPIList.data=a.customerModelDataData().custom_kpi_data,e.modelKPIList.data=a.customerModelDataData().model_based_kpi_data,d(),s("sport_bet"),c("sport_bet")}function r(e,t){var i,o=[],n=a.customerModelDataData()[e];for(i=0;i<n.length;i++)o[i]=n[i][t];return o}function s(t){e.customKPITrendobj={options:{chart:{type:"line"}},series:[{data:r(t,"value")}],title:{text:"13 weeks Trend Report"},credits:{enabled:!1},loading:!1}}function c(t){e.modelBasedTrendConfig={options:{chart:{type:"line"}},series:[{data:r("sport_bet","value")}],title:{text:"13 weeks Trend Report"},credits:{enabled:!1},loading:!1}}function d(){e.liveCustomerTrendsChartConfig={options:{chart:{plotBackgroundColor:null,plotBorderWidth:null,plotShadow:!1,type:"column"},colors:["#058DC7","#50B432","#ED561B"],plotOptions:{pie:{allowPointSelect:!0,cursor:"pointer",dataLabels:{enabled:!1},showInLegend:!0}},legend:{enabled:!0},credits:{enabled:!1},tooltip:{pointFormat:"{series.name}: <b>{point.y}%</b>"}},credits:{enabled:!1},title:{text:"Distribution",align:"left"},series:[{name:"became_churn",data:r("live_customers_trend","became_churn")},{name:"became_live",data:r("live_customers_trend","became_live")},{type:"spline",name:"NO Of live customers",data:r("live_customers_trend","NoOf_live_customers")}],loading:!1},e.futurePredictionChartConfig={options:{chart:{type:"column"},colors:["#e45d15","#50B432","#ED561B"],legend:{align:"right",x:-30,verticalAlign:"top",y:25,floating:!0,backgroundColor:Highcharts.theme&&Highcharts.theme.background2||"white",borderColor:"#CCC",borderWidth:1,shadow:!1},xAxis:{categories:r("predicted_future_value","date")},yAxis:{min:0,title:{text:"Future Value Prediction"}}},plotOptions:{column:{stacking:"normal",dataLabels:{enabled:!0,color:Highcharts.theme&&Highcharts.theme.dataLabelsColor||"white"}}},credits:{enabled:!1},series:[{name:"Acquisition Fv",data:r("predicted_future_value","acquisition_fv")},{name:"Database Fv",data:r("predicted_future_value","database_fv")}],title:{text:"Future Trend Prediction"},loading:!1},e.futurePredictionDonut={options:{chart:{type:"pie",options3d:{enabled:!0,alpha:45}},colors:["#ED561B","#5C2508"]},plotOptions:{pie:{innerSize:100,depth:45}},credits:{enabled:!1},series:[{name:"Future Prediction",data:[["AcquisitionFv",25],["DatabaseFv",75]]}],title:{text:"Future Trend"},loading:!1}}e.mecampaignsList={data:[]},e.customKPIList={data:[]},e.modelKPIList={data:[]},n(),e.trendof13=function(e){s(e),i("trendrep")},e.campAnalysisPopup=function(e){alert("Action"+e),o.open("http://localhost:3000/app/#/analyticalReps","popup","width=950,height=600,left=10,top=50")},e.modelBasedTrend=function(e){c(e),i("modelBasedTrend")}})}(),function(){"use strict";function e(e){function t(){e.GetCurrent().then(function(e){i.user=e})}var i=this;i.user=null,t()}angular.module("app").controller("PlayerCampaign.IndexController",e)}(),function(){"use strict";function e(e,t,i,a){function o(){e.GetCurrent().then(function(e){l.user=e})}function n(e,t){var i,o=[],n=a.customerModelDataData()[t],l=0;for(i=0;i<n.length;i++)if(n[i].Period===e){var r=n[i];console.log("Data::",r),o[l]=r,l+=1}return o}var l=this;alert("Here"),l.user=null,t.trend={value:"Net Revenue"},t.distribution={period:"2016_09_10"},t.meCampList={data:[]},t.meCampList.data=n(t.distribution.period,"valueseg"),o()}angular.module("app").controller("analyticalcontroller",e)}(),function(){"use strict";function e(e,t,i){function a(){t.GetCurrent().then(function(e){l.user=e})}function o(){t.Update(l.user).then(function(){i.Success("User updated")}).catch(function(e){i.Error(e)})}function n(){t.Delete(l.user._id).then(function(){e.location="/login"}).catch(function(e){i.Error(e)})}var l=this;l.user=null,l.saveUser=o,l.deleteUser=n,a()}angular.module("app").controller("Account.Controller",e)}();